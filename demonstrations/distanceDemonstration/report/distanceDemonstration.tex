  
\documentclass[12pt,a4paper,fleqn]{tufte-handout} 
\usepackage{graphicx} 
\usepackage{morefloats} 
\usepackage{amsmath} 
\usepackage{amssymb} 
\usepackage{rotating} 
% mcode options for matlab code insertion bw (for printing), numbered (line numbers), framed (frame around code blocks), useliterate (convert Matlab expressions to Latex ones), autolinebreaks (automatic code wraping, use it with caution 
\usepackage[literate]{mcode} 
\graphicspath{{figures/}{report/figures/}{../figures/}{../../}{../}}  
\title{distanceDemonstration} 
\author{ Mathieu Lagrange } 
  
\begin{document} 
  
\maketitle 
  
% Please use this file to document your experiment 
% You can compile the report by setting the option 'report' as detailed in your expCode configuration file. 

\section{Introduction}

This document documents the first demonstration of the use of the expCode framework to conduct a computational experiment. The project \textsc{distanceDemonstration} is about the comparison of several distances over synthetic data.

\section{Design}

 The project is divided into two processing steps:
\begin{enumerate}
\item \textbf{generate}: generation of the synthetic datasets
\item \textbf{compute}: computation of the distances over those datasets and performance metrics
\end{enumerate}

\subsection{Generation of synthetic datasets}

Each dataset comprises a set of points in a space of given dimensionality. Those points are grouped into classes whose centroid are spread along the diagonal. The degree of overlap between classes is controlled by the spread of the points with respect to the centroid of its class. The needed factors of variability that are to be tested are:
\begin{enumerate}
\item the number of classes
\item the dimensionality of the space
\item the spread of the data points of a given class
\item the number of replications
\item the number of data points per class.
\end{enumerate}

\begin{marginfigure}
\includegraphics[width=\textwidth]{figures/scatter}
\caption{A dataset with maximal spread.}
\label{scatter}
\end{marginfigure}

This step outputs for each dataset the location of the data points (elements) as well as the class to which they belong to (class).

\subsection{Computation of distances}

Once the datasets are generated, we can compute the distances between all points of a given dataset. The factor for this step is then:
\begin{enumerate}
\item the type of distances.
\end{enumerate}

\subsection{Observations}

Since we consider distances between data points that each belong to a given class, ranking metrics are appropriate to evaluate the performance of those distances on the generated datasets. More precisely, we consider the following metrics:
\begin{enumerate}
\item map: mean average precision
\item precision: precision at rank 5.
\end{enumerate}

\section{Definition of factors}

Those factors and their corresponding modalities are defined in the file named \texttt{dideFactors.txt} whose content is the following:
\lstinputlisting{../dideFactors.txt}

Please note the 2 between the first two equals of the factor definition of factor \textit{distance} which specify that this factor is needed only for the second processing step. Most the factor design diccused above is compactly displayed in Figure \ref{factorFlowGraph}. \texttt{nbRealizations} and \texttt{nbElementsPerClass} are fixed modalities.

\input{tex/exposeTmp} % expCodeInsertionFlag DO NOT CLEAR (but move it where you want the generated temporary LaTEX code to be inserted) 
  
\section{Implementation}

Each processing step his implemented in a given file.

\subsection{Step 1: generate}

The datasets are generated with the following code:
\lstinputlisting[firstline=20, lastline=26]{../dide1generate.m}

\subsection{Step 2: compute} 


The data points are retrieved and, for some distances, pre-processed as follows:
\lstinputlisting[firstline=20, lastline=26]{../dide2compute.m} 

Then, the actual distances are computed as follows:
\lstinputlisting[firstline=27, lastline=37]{../dide2compute.m} 
Since the complete distance matrix is symmetric, only half the values are computed.

The observations are generated and stored as follows:
  \lstinputlisting[firstline=38, lastline=40]{../dide2compute.m} 
  
  
%\bibliographystyle{abbrvnat} 
%\bibliography{} 
  
\end{document} 
